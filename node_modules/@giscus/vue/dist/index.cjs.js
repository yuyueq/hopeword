"use strict";var e=Object.defineProperty,t=Object.defineProperties,s=Object.getOwnPropertyDescriptors,r=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable,i=(t,s,r)=>s in t?e(t,s,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[s]=r;Object.defineProperty(exports,"__esModule",{value:!0}),exports[Symbol.toStringTag]="Module";var a=require("vue");const c="Please consider reporting this error at https://github.com/laymonage/giscus/issues/new.";function u(e){return`[giscus] An error occurred. Error message: "${e}".`}function l(e){const t=document.querySelector(`meta[property='og:${e}'],meta[name='${e}']`);return t?t.content:""}function g(){const e=document.getElementById("giscus-css")||document.createElement("style");e.id="giscus-css",e.textContent="\n    .giscus, .giscus-frame {\n      width: 100%;\n    }\n    .giscus-frame {\n      border: none;\n      color-scheme: normal;\n    }\n  ",document.head.prepend(e)}const d=a.defineComponent({props:{repo:{type:String,required:!0},repoId:{type:String,required:!0},category:String,categoryId:String,mapping:{type:String,required:!0},term:String,lang:{type:String,default:"en"},theme:{type:String,default:"light"},reactionsEnabled:{type:String,default:"1"},emitMetadata:{type:String,default:"0"},inputPosition:{type:String,default:"bottom"}},setup(e){const d=a.ref(""),m=a.computed((()=>{return function({repo:e,repoId:t,category:s="",categoryId:r="",mapping:n,term:o="",theme:i="light",reactionsEnabled:a="1",emitMetadata:c="0",inputPosition:u="bottom",lang:g="en",session:d,origin:m}){const p=new URL(location.href);p.searchParams.delete("giscus");const f=p.toString(),y={origin:m=m||f,session:d,theme:i,reactionsEnabled:a,emitMetadata:c,inputPosition:u,repo:e,repoId:t,category:s,categoryId:r,description:l("description")};switch(n){case"url":y.term=f;break;case"title":y.term=document.title;break;case"og:title":y.term=l("title");break;case"specific":y.term=o;break;case"number":y.number=o;break;case"pathname":default:y.term=location.pathname.length<2?"index":location.pathname.substring(1).replace(/\.\w+$/,"")}return`https://giscus.app/${g}/widget?${new URLSearchParams(y)}`}((a=((e,t)=>{for(var s in t||(t={}))n.call(t,s)&&i(e,s,t[s]);if(r)for(var s of r(t))o.call(t,s)&&i(e,s,t[s]);return e})({},e),c={session:d.value},t(a,s(c))));var a,c}));a.onMounted((()=>{const e=location.href,t=new URL(e),s=localStorage.getItem("giscus-session");if(d.value=t.searchParams.get("giscus")||"",d.value)localStorage.setItem("giscus-session",JSON.stringify(d.value)),t.searchParams.delete("giscus"),history.replaceState(void 0,document.title,t.toString());else if(s)try{d.value=JSON.parse(s||"")||""}catch(r){d.value="",localStorage.removeItem("giscus-session"),console.warn(`${u(null==r?void 0:r.message)} Session has been cleared.`)}})),a.onMounted(g);const p=a.ref();return a.onMounted((()=>{const e=function(e,t=null){return function(s){if("https://giscus.app"!==s.origin)return;const{data:r}=s;if("object"!=typeof r||!r.giscus)return;if(t&&r.giscus.resizeHeight&&(t.style.height=`${r.giscus.resizeHeight}px`),!r.giscus.error)return;const n=r.giscus.error;if(n.includes("Bad credentials")||n.includes("Invalid state value")){if(null!==localStorage.getItem("giscus-session"))return localStorage.removeItem("giscus-session"),e(),void console.warn(`${u(n)} Session has been cleared.`);console.error(`${u(n)} No session is stored initially. ${c}`)}n.includes("Discussion not found")?console.warn(`[giscus] ${n}. A new discussion will be created if a comment/reaction is submitted.`):console.error(`${u(n)} ${c}`)}}((()=>d.value=""),p.value);window.addEventListener("message",e),a.onUnmounted((()=>window.removeEventListener("message",e)))})),()=>a.createVNode("div",{className:"giscus"},[a.createVNode("iframe",{className:"giscus-frame",title:"Comments",scrolling:"no",src:m.value,ref:p},null)])}}),m={install:e=>e.component("Giscus",d)};exports.Giscus=d,exports.plugin=m;
