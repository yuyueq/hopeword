import { getDate } from "@mr-hope/vuepress-shared/lib/client";
import { computed, inject, provide } from "vue";
import { useBlogType } from "vuepress-plugin-blog2/lib/client";
export const timelinesSymbol = Symbol.for("timelines");
/**
 * Inject timelines
 */
export const useTimelines = () => {
    const timelines = inject(timelinesSymbol);
    if (!timelines) {
        throw new Error("useTimelines() is called without provider.");
    }
    return timelines;
};
/**
 * Provide timelines
 */
export const setupTimelines = () => {
    const timelines = useBlogType("timeline");
    const timelineItems = computed(() => {
        const timelineItems = [];
        // filter before sort
        timelines.value.items.forEach(({ info, path }) => {
            var _a;
            const { year, month, day } = ((_a = getDate(info.date, { type: "date" })) === null || _a === void 0 ? void 0 : _a.detail) || {};
            if (year && month && day) {
                if (!timelineItems[0] || timelineItems[0].year !== year)
                    timelineItems.unshift({ year, items: [] });
                timelineItems[0].items.push({
                    date: `${month}/${day}`,
                    info,
                    path,
                });
            }
        });
        return {
            ...timelines.value,
            config: timelineItems.reverse(),
        };
    });
    provide(timelinesSymbol, timelineItems);
};
//# sourceMappingURL=timelines.js.map