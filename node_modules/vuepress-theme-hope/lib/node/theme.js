"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.themeHope = void 0;
const utils_1 = require("@vuepress/utils");
const alias_1 = require("./alias");
const bundler_1 = require("./bundler");
const getThemeConfig_1 = require("./getThemeConfig");
const extends_1 = require("./extends");
const layout_1 = require("./layout");
const plugins_1 = require("./plugins");
const socialMedia_1 = require("./socialMedia");
const sidebar_1 = require("./sidebar");
const themeColor_1 = require("./themeColor");
const themeHope = ({ plugins = {}, hostname = "", ...themeOptions }, app) => {
    const enableBlog = Boolean(plugins.blog);
    const themeConfig = (0, getThemeConfig_1.getThemeConfig)(app, themeOptions);
    (0, plugins_1.usePlugin)(app, plugins);
    if (enableBlog) {
        const icons = (0, socialMedia_1.checkSocialMediaIcons)(themeConfig);
        void app.writeTemp(`theme-hope/socialMedia.js`, `export const icons = ${JSON.stringify(icons)}`);
    }
    return {
        name: "vuepress-theme-hope",
        alias: (0, alias_1.getAlias)(app),
        define: () => ({
            ENABLE_BLOG: enableBlog,
            ENABLE_VISITOR: plugins.comment && plugins.comment.type === "waline",
        }),
        extendsPage: (page) => (0, extends_1.extendsPage)(themeConfig, plugins, page, app.env.isDev),
        onInitialized: (app) => (0, bundler_1.updateBundlerOptions)(app),
        onPrepared: () => Promise.all([
            (0, sidebar_1.prepareSidebarData)(app, themeConfig),
            (0, themeColor_1.prepareThemeColorScss)(app, themeConfig),
        ]).then(() => void 0),
        plugins: (0, plugins_1.getPluginConfig)(app, plugins, themeConfig, hostname),
        layouts: (0, layout_1.getLayoutConfig)(app, plugins),
        templateBuild: utils_1.path.resolve(__dirname, "../../templates/index.build.html"),
        clientAppEnhanceFiles: [
            utils_1.path.resolve(__dirname, "../client/appEnhance.js"),
            utils_1.path.resolve(__dirname, "../client/module/navbar/appEnhance.js"),
            utils_1.path.resolve(__dirname, "../client/module/sidebar/appEnhance.js"),
            ...(enableBlog
                ? [utils_1.path.resolve(__dirname, "../client/module/blog/appEnhance.js")]
                : []),
        ],
        clientAppSetupFiles: [
            ...(enableBlog
                ? [utils_1.path.resolve(__dirname, "../client/module/blog/appSetup.js")]
                : []),
            utils_1.path.resolve(__dirname, "../client/module/outlook/appSetup.js"),
            utils_1.path.resolve(__dirname, "../client/module/sidebar/appSetup.js"),
        ],
    };
};
exports.themeHope = themeHope;
//# sourceMappingURL=theme.js.map